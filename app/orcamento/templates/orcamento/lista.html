
{% extends 'base.html' %}
{% block title %}Lista de Orçamentos{% endblock %}

{% block content %}

<div class="container mt-4">
	<!-- Cards de estatísticas -->
	<div class="row mb-4">
		<div class="col-md-3">
			<div class="stats-card text-center border-orange">
				<i class="fas fa-file-invoice-dollar fa-2x mb-2 text-orange"></i>
				<h4>{{ orcamentos|length }}</h4>
				<p class="mb-0">Total de Orçamentos</p>
			</div>
		</div>
		<div class="col-md-3">
			<div class="stats-card text-center border-orange">
				<i class="fas fa-users fa-2x mb-2 text-orange"></i>
				<h4>{{ orcamentos|selectattr('status', 'equalto', 'Aprovado')|list|length }}</h4>
				<p class="mb-0">Aprovados</p>
			</div>
		</div>
		<div class="col-md-3">
			<div class="stats-card text-center border-orange">
				<i class="fas fa-clock fa-2x mb-2 text-orange"></i>
				<h4>{{ orcamentos|selectattr('status', 'equalto', 'Pendente')|list|length }}</h4>
				<p class="mb-0">Pendentes</p>
			</div>
		</div>
		<div class="col-md-3">
			<div class="stats-card text-center border-orange">
				<i class="fas fa-money-bill-wave fa-2x mb-2 text-orange"></i>
				<h4>R$ {{ '%.2f'|format(orcamentos|sum(attribute='valor_total')) }}</h4>
				<p class="mb-0">Valor Total</p>
			</div>
		</div>
	</div>

	<div class="d-flex justify-content-between align-items-center mb-3">
		<h2 class="text-orange">Orçamentos</h2>
		<a href="{{ url_for('orcamento.novo_orcamento') }}" class="btn btn-warning">
			<i class="fas fa-plus"></i> Novo Orçamento
		</a>
	</div>
	<div class="card border-orange">
		<div class="card-body p-0">
			<table class="table table-hover mb-0">
				<thead class="bg-orange text-white">
					<tr>
						<th>Código</th>
						<th>Cliente</th>
						<th>Data</th>
						<th>Valor Total</th>
						<th>Status</th>
						<th>Ações</th>
					</tr>
				</thead>
				<tbody>
					{% for orcamento in orcamentos %}
					<tr>
						<td>{{ orcamento.codigo }}</td>
						<td>{{ orcamento.cliente.nome }}</td>
						<td>{{ orcamento.data_criacao.strftime('%d/%m/%Y') }}</td>
						<td>R$ {{ '%.2f'|format(orcamento.valor_total) }}</td>
						<td>{{ orcamento.status }}</td>
						<td>
							<a href="{{ url_for('orcamento.visualizar_orcamento', id=orcamento.id) }}" class="btn btn-sm btn-outline-primary" title="Visualizar"><i class="fas fa-eye"></i></a>
							<a href="{{ url_for('orcamento.editar_orcamento', id=orcamento.id) }}" class="btn btn-sm btn-outline-warning" title="Editar"><i class="fas fa-edit"></i></a>
							<a href="{{ url_for('orcamento.excluir_orcamento', id=orcamento.id) }}" class="btn btn-sm btn-outline-danger" title="Excluir" onclick="return confirm('Tem certeza que deseja excluir este orçamento?');"><i class="fas fa-trash"></i></a>
						</td>
					</tr>
					{% else %}
					<tr>
						<td colspan="6" class="text-center">Nenhum orçamento cadastrado.</td>
					</tr>
					{% endfor %}
				</tbody>
			</table>
		</div>
	</div>
</div>

<style>
.text-orange { color: #ff9800; }
.bg-orange { background-color: #ff9800 !important; }
.border-orange { border: 1px solid #ff9800 !important; }
.stats-card {
	background: #fff;
	border-radius: 16px;
	box-shadow: 0 2px 8px #ff980033;
	padding: 18px 0 10px 0;
	margin-bottom: 10px;
}
</style>
{% endblock %}
