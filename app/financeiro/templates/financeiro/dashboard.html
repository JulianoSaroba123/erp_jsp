{% extends 'base.html' %}

{% block content %}
<div class="container-fluid">
  <!-- Título da página -->
  <div class="page-title">
    <div class="ico"><i class="fas fa-chart-line"></i></div>
    <h1>Dashboard Financeiro</h1>
  </div>

  <div class="card-jsp">
    <div class="card-header">
      <h5 class="mb-0">Período: {{ periodo[0].strftime('%d/%m/%Y') }} a {{ periodo[1].strftime('%d/%m/%Y') }}</h5>
    </div>
    <div class="card-body">
      <!-- KPIs principais -->
      <div class="row g-3 mb-4">
        <div class="col-md-3">
          <div class="kpi text-center">
            <i class="fas fa-arrow-up text-success mb-2" style="font-size: 1.5rem;"></i>
            <div><strong>Receitas</strong></div>
            <div class="fs-4 fw-bold text-success">{{ "%.2f"|format(receitas)|replace(".", ",")|replace(",", "X")|replace(".", ",")|replace("X", ".") }}</div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="kpi text-center">
            <i class="fas fa-arrow-down text-danger mb-2" style="font-size: 1.5rem;"></i>
            <div><strong>Despesas</strong></div>
            <div class="fs-4 fw-bold text-danger">R$ {{ "%.2f"|format(despesas)|replace(".", ",")|replace(",", "X")|replace(".", ",")|replace("X", ".") }}</div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="kpi text-center">
            <i class="fas fa-balance-scale mb-2" style="font-size: 1.5rem; color: {% if saldo >= 0 %}#28a745{% else %}#dc3545{% endif %};"></i>
            <div><strong>Saldo</strong></div>
            <div class="fs-4 fw-bold" style="color: {% if saldo >= 0 %}#28a745{% else %}#dc3545{% endif %};">R$ {{ "%.2f"|format(saldo)|replace(".", ",")|replace(",", "X")|replace(".", ",")|replace("X", ".") }}</div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="kpi text-center">
            <i class="fas fa-chart-pie text-warning mb-2" style="font-size: 1.5rem;"></i>
            <div><strong>PE (R$)</strong></div>
            <div class="fs-4 fw-bold text-warning">R$ {{ "%.2f"|format(pe_reais)|replace(".", ",")|replace(",", "X")|replace(".", ",")|replace("X", ".") }}</div>
          </div>
        </div>
      </div>

      <!-- KPIs secundários -->
      <div class="row g-3 mb-4">
        <div class="col-md-3">
          <div class="kpi text-center">
            <div><strong>Receita (DRE)</strong></div>
            <div class="fs-5">R$ {{ "%.2f"|format(rec_dre)|replace(".", ",")|replace(",", "X")|replace(".", ",")|replace("X", ".") }}</div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="kpi text-center">
            <div><strong>Despesas (DRE)</strong></div>
            <div class="fs-5">R$ {{ "%.2f"|format(des_dre)|replace(".", ",")|replace(",", "X")|replace(".", ",")|replace("X", ".") }}</div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="kpi text-center">
            <div><strong>Lucro (DRE)</strong></div>
            <div class="fs-5" style="color: {% if lucro >= 0 %}#28a745{% else %}#dc3545{% endif %};">R$ {{ "%.2f"|format(lucro)|replace(".", ",")|replace(",", "X")|replace(".", ",")|replace("X", ".") }}</div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="kpi text-center">
            <div><strong>Valor-hora</strong></div>
            <div class="fs-5">R$ {{ "%.2f"|format(valor_hora)|replace(".", ",")|replace(",", "X")|replace(".", ",")|replace("X", ".") }}</div>
            <small class="text-muted">(base R$ {{ "%.2f"|format(base_hora)|replace(".", ",")|replace(",", "X")|replace(".", ",")|replace("X", ".") }})</small>
          </div>
        </div>
      </div>

      <!-- Botões de ação -->
      <div class="d-flex gap-2 flex-wrap">
        <a class="btn btn-brand fw-bold shadow-sm d-flex align-items-center gap-2" href="{{ url_for('financeiro.listar') }}">
          <i class="fas fa-list"></i> Lançamentos
        </a>
        <a class="btn btn-brand fw-bold shadow-sm d-flex align-items-center gap-2" href="{{ url_for('financeiro.novo') }}">
          <i class="fas fa-plus"></i> Novo Lançamento
        </a>
        <a class="btn btn-brand fw-bold shadow-sm d-flex align-items-center gap-2" href="{{ url_for('configuracoes_condicoes_pagamento.listar_condicoes_pagamento') }}">
          <i class="fas fa-tags"></i> Categorias
        </a>
        <a class="btn btn-brand fw-bold shadow-sm d-flex align-items-center gap-2" href="{{ url_for('configuracoes_condicoes_pagamento.listar_condicoes_pagamento') }}">
          <i class="fas fa-university"></i> Contas
        </a>
        <a class="btn btn-brand fw-bold shadow-sm d-flex align-items-center gap-2" href="{{ url_for('configuracoes_condicoes_pagamento.listar_condicoes_pagamento') }}">
          <i class="fas fa-sliders-h"></i> Configurações
        </a>
      </div>
    </div>
  </div>
</div>

<style>
  .btn.btn-brand {
    min-width: 160px;
    font-size: 1.08rem;
    border-radius: 8px;
    letter-spacing: 0.5px;
    transition: transform 0.08s;
  }
  .btn.btn-brand:hover {
    transform: translateY(-2px) scale(1.04);
  }
</style>
{% endblock %}
